<div class="d-flex w-100">
  <ng-template
    #currencyListTmpl
    let-matches="matches"
    let-query="query"
    let-typeaheadTemplateMethods
  >
    <ng-template
      ngFor
      let-match
      let-i="index"
      [ngForOf]="matches"
    >
      <ng-template [ngIf]="!match.isHeader()">
        <button
          #liElements
          class="dropdown-item py-0"
          (click)="typeaheadTemplateMethods.selectMatch(match, $event)"
          (mouseenter)="typeaheadTemplateMethods.selectActive(match)"
          [class.active]="typeaheadTemplateMethods.isActive(match)"
        >
          {{match.item}}
        </button>
      </ng-template>
    </ng-template>
  </ng-template>
  <input
    container="body"
    class="form-control form-control-sm py-0 me-1"
    [readonly]="readonly"
    [placeholder]="!readonly ? ('MODELS.CURRENCY' | translate | lowercase) : ''"
    [ngModel]="readonly? (transaction?.currency | csymbol) : transaction?.currency"
    [optionsListTemplate]="currencyListTmpl"
    [typeahead]="currencies"
    [typeaheadHideResultsOnBlur]="false"
    (typeaheadOnSelect)="onCurrencyChange($event.item)"
  />
  <input
    class="form-control form-control-sm py-0 text-end"
    [readonly]="readonly"
    [placeholder]="!readonly ? ('MODELS.AMOUNT' | translate | lowercase) : ''"
    [ngModel]="readonly? (transaction?.amount | acct:2) : (absAmount | number:'1.2-2')"
    (ngModelChange)="_amountExpr = $event"
    (blur)="onAmountChange()"
    (keypress)="filterUserInput($event)"
  >
</div>
<div
  class="d-flex w-100 input-group input-group-sm mt-1"
  *ngIf="!readonly && exchangeRateNeeded()"
>
  <span
    class="input-group-text col-3 py-0"
  >{{'MODELS.EXCHANGE_RATE_ABBR' | translate}}</span>
  <input
    class="form-control py-0 text-end"
    [placeholder]="'MODELS.EXCHANGE_RATE' | translate | lowercase"
    [ngModel]="transaction?.exchangeRate"
    (ngModelChange)="_exchangeRateExpr = $event"
    (blur)="onExchangeRateChange()"
    (keypress)="filterUserInput($event)"
  >
</div>
<div
  class="d-flex w-100 input-group input-group-sm mt-1"
  *ngIf="!readonly && transaction?.payee?.isTrade"
>
  <span
    class="input-group-text col-3 py-0"
  >{{'MODELS.UNIT_PRICE_ABBR' | translate}}</span>
  <input
    class="form-control py-0 text-end"
    [placeholder]="'MODELS.UNIT_PRICE' | translate | lowercase"
    [ngModel]="transaction?.unitPrice"
    (ngModelChange)="_unitPriceExpr = $event"
    (blur)="onUnitPriceChange()"
    (keypress)="filterUserInput($event)"
  >
</div>
<div
  class="d-flex w-100 input-group input-group-sm mt-1"
  *ngIf="!readonly && transaction?.payee?.isTrade"
>
  <span
    class="input-group-text col-3 py-0"
  >{{'MODELS.QUANTITY_ABBR' | translate}}</span>
  <input
    class="form-control py-0 text-end"
    [placeholder]="'MODELS.QUANTITY' | translate | lowercase"
    [ngModel]="transaction?.quantity"
    (ngModelChange)="_quantityExpr = $event"
    (blur)="onQuantityChange()"
    (keypress)="filterUserInput($event)"
  >
</div>
